import numpy
import json
import matplotlib.pyplot as plt
import os

t = {
    "input": {
        "corsika_particle_id": 3,
        "site": {
            "earth_magnetic_field_x_muT": 20.815,
            "earth_magnetic_field_z_muT": -11.366,
            "observation_level_altitude_asl": 5000.0,
            "corsika_atmosphere_model": 26
        },
        "initial": {
            "energy": 14.0,
            "energy_iteration_factor": 0.95,
            "instrument_radius": 1000.0,
            "instrument_x": 0.0,
            "instrument_y": 0.0,
            "azimuth_phi_deg": 0.0,
            "zenith_theta_deg": 0.0,
            "scatter_angle_deg": 5.0
        },
        "energy_lower_limit": 0.6,
        "energy_thrown_per_iteration": 400.0,
        "target_cx": 0.0,
        "target_cy": 0.0,
        "target_containment_angle_deg": 2.5
    },
    "energy": [
        14.0,
        13.299999999999999,
        12.634999999999998,
        12.003249999999998,
        11.403087499999998,
        10.832933124999998,
        10.291286468749998,
        9.776722145312498,
        9.287886038046873,
        8.823491736144529,
        8.382317149337302,
        7.963201291870437,
        7.5650412272769145,
        7.186789165913068,
        6.827449707617414,
        6.486077222236543,
        6.161773361124715,
        5.853684693068479,
        5.561000458415055,
        5.282950435494302,
        5.018802913719587,
        4.767862768033607,
        4.529469629631927,
        4.3029961481503305,
        4.087846340742813,
        3.8834540237056725,
        3.689281322520389,
        3.5048172563943694,
        3.3295763935746505,
        3.163097573895918,
        3.004942695201122,
        2.8546955604410655,
        2.711960782419012,
        2.5763627432980614,
        2.447544606133158,
        2.3251673758265,
        2.208909007035175,
        2.098463556683416,
        1.9935403788492452,
        1.893863359906783,
        1.7991701919114436,
        1.7092116823158714,
        1.6237510982000778,
        1.5425635432900737,
        1.46543536612557,
        1.3921635978192914,
        1.3573595078738092,
        1.323425520176964,
        1.2903398821725398,
        1.2580813851182262,
        1.2423553678042485,
        1.2268259257066954,
        1.2114906016353617,
        1.1963469691149198,
        1.1813926320009833,
        1.1666252241009711,
        1.152042408799709,
        1.1376418786897127,
        1.130531616947902,
        1.1234657943419777,
        1.1164441331273403,
        1.1094663572952943,
        1.1025321925621987,
        1.095641366358685,
        1.0887936078189433,
        1.0819886477700749,
        1.075226218721512,
        1.0685060548545027,
        1.0618278920116622,
        1.0551914676865892,
        1.0485965210135482,
        1.0420427927572136,
        1.0387864090298473,
        1.035540201501629,
        1.0323041383719365
    ],
    "energy_iteration_factor": [
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.95,
        0.975,
        0.975,
        0.975,
        0.975,
        0.9875,
        0.9875,
        0.9875,
        0.9875,
        0.9875,
        0.9875,
        0.9875,
        0.9875,
        0.99375,
        0.99375,
        0.99375,
        0.99375,
        0.99375,
        0.99375,
        0.99375,
        0.99375,
        0.99375,
        0.99375,
        0.99375,
        0.99375,
        0.99375,
        0.99375,
        0.996875,
        0.996875,
        0.996875
    ],
    "instrument_radius": [
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1000.0,
        1021.5053551467795,
        1041.5630775013299,
        1041.5630775013299,
        1041.5630775013299,
        1390.076499530835,
        1475.9887013094226,
        1475.9887013094226,
        1475.9887013094226,
        1475.9887013094226,
        1779.8872721090324,
        1779.8872721090324,
        1779.8872721090324,
        2027.849411379571,
        2500.0,
        2500.0,
        2500.0,
        2500.0,
        2500.0,
        2500.0,
        2500.0,
        2500.0,
        2500.0,
        2500.0,
        2500.0,
        2500.0,
        2500.0,
        2500.0,
        2500.0
    ],
    "instrument_x": [
        -6.136470794677734,
        -32.83930206298828,
        -26.5008487701416,
        -39.34283256530762,
        -50.41799831390381,
        -38.03814506530762,
        -92.51017189025879,
        -79.86737060546875,
        -80.0220223814249,
        -80.79406215250492,
        -85.67984391748905,
        -90.95750524103642,
        -111.85990335047245,
        -122.79938317835331,
        -101.28373147547245,
        -104.79150201380253,
        -127.97766686975956,
        -164.9515228420496,
        -172.72231103479862,
        -172.04183681309223,
        -213.4420977383852,
        -209.01946552097797,
        -265.7637053281069,
        -300.96823032200336,
        -329.6876059323549,
        -341.10555942356586,
        -409.9508532434702,
        -437.76485146582127,
        -499.8107766062021,
        -545.2181853204966,
        -610.0577010065317,
        -673.4351509958506,
        -754.8078431040049,
        -837.428048029542,
        -968.1344880014658,
        -1082.1991986185312,
        -1215.159861460328,
        -1408.01534165442,
        -1560.7179898172617,
        -1819.4908398538828,
        -2114.967333689332,
        -2340.2058934122324,
        -2640.9083012491465,
        -3057.7946461588144,
        -3397.397265329957,
        -3819.565391436219,
        -4009.946708574891,
        -4246.520385637879,
        -4407.508666887879,
        -4568.950977221131,
        -4647.223506823182,
        -4808.048487558961,
        -4995.585604563355,
        -5017.803021326661,
        -5211.064801111817,
        -5247.71495141089,
        -5299.950531855226,
        -5361.081860437989,
        -5177.914791956544,
        -5256.724509134889,
        -5911.049742594361,
        -6547.774763956666,
        -6634.551054850221,
        -6654.669421091676,
        -6624.919138804078,
        -6765.739188089967,
        -6755.3622521311045,
        -6727.833926096559,
        -6659.7481449991465,
        -6580.511896982789,
        -6559.061526194215,
        -6284.912054911256,
        -6212.937340632081,
        -6309.854905024171,
        -6145.503128901124
    ],
    "instrument_y": [
        -1.9179110527038574,
        -54.36671781539917,
        -57.37285041809082,
        -68.41003131866455,
        -120.2773790359497,
        -93.43785762786865,
        -68.39044857025146,
        -32.94749689102173,
        -113.89444971084595,
        -100.88889074325562,
        -106.21065855026245,
        -123.74546003341675,
        -100.84818077087402,
        -106.31988000869751,
        -125.30305337905884,
        -146.25918817520142,
        -193.7296166419983,
        -180.1349606513977,
        -172.8997631072998,
        -155.4439344406128,
        -194.7664098739624,
        -253.47892665863037,
        -251.09623193740845,
        -297.9234356880188,
        -305.9687542915344,
        -357.5196576118469,
        -410.4882321357727,
        -460.41720819473267,
        -478.7243800163269,
        -549.053288936615,
        -610.5999846458435,
        -689.2340569496155,
        -804.1459946632385,
        -911.2181344032288,
        -1084.394672870636,
        -1237.709053516388,
        -1417.8216786384583,
        -1621.2119870185852,
        -1896.0635800361633,
        -2189.6735348701477,
        -2579.726231098175,
        -2927.8870129585266,
        -3471.179142475128,
        -3986.4777493476868,
        -4542.653370380402,
        -5264.339939594269,
        -5511.2912793159485,
        -5866.716465473175,
        -6305.6307721138,
        -6634.810215473175,
        -6860.111652851105,
        -7379.477165699005,
        -7834.228691577911,
        -8043.578941822052,
        -8151.012138843536,
        -8539.397514820099,
        -8844.243172168732,
        -8842.014391183853,
        -8946.863420724869,
        -9294.791486024857,
        -9977.528289079666,
        -10686.891297578812,
        -10895.617310762405,
        -11132.092850923538,
        -11115.999924898148,
        -11210.904656648636,
        -11429.447610139847,
        -11282.015482187271,
        -11508.28583741188,
        -11504.641802072525,
        -11503.114496469498,
        -11283.179945230484,
        -11534.101759195328,
        -11246.368513345718,
        -11775.064802408218
    ],
    "azimuth_phi_deg": [
        -74.46662139892578,
        -88.76555633544922,
        -96.9826431274414,
        -90.31008911132812,
        -86.59020233154297,
        -87.85929107666016,
        -83.63381958007812,
        -90.03279113769531,
        -88.03826904296875,
        -87.66461181640625,
        -86.65817260742188,
        -88.32189178466797,
        -91.84071350097656,
        -91.45442199707031,
        -93.93140411376953,
        -93.71680450439453,
        -95.6854476928711,
        -89.73030853271484,
        -89.10686492919922,
        -89.94647979736328,
        -91.28781127929688,
        -92.35212707519531,
        -90.5385971069336,
        -90.29700469970703,
        -92.65805053710938,
        -90.79830169677734,
        -92.62178802490234,
        -93.83727264404297,
        -95.35492706298828,
        -93.46183013916016,
        -92.84493255615234,
        -94.36915588378906,
        -93.73046112060547,
        -93.28857421875,
        -94.27645111083984,
        -94.6941909790039,
        -94.15707397460938,
        -93.64202117919922,
        -94.8420639038086,
        -95.39414978027344,
        -95.99055480957031,
        -96.37055969238281,
        -96.48983764648438,
        -97.68099212646484,
        -97.54680633544922,
        -98.44342803955078,
        -98.64324951171875,
        -98.98810577392578,
        -99.18019104003906,
        -98.86354064941406,
        -99.10245513916016,
        -98.48991394042969,
        -98.81329345703125,
        -98.8625717163086,
        -98.98826599121094,
        -98.27799987792969,
        -98.38302612304688,
        -98.7100601196289,
        -98.18383026123047,
        -98.75830078125,
        -97.57667541503906,
        -98.81160736083984,
        -98.6063461303711,
        -98.56803894042969,
        -99.06547546386719,
        -98.12361145019531,
        -98.50482940673828,
        -99.169921875,
        -98.98210906982422,
        -98.0776596069336,
        -98.10411834716797,
        -98.03446197509766,
        -98.2452163696289,
        -98.39605712890625,
        -99.33904266357422
    ],
    "zenith_theta_deg": [
        2.8985157012939453,
        3.2213377952575684,
        3.0950496196746826,
        3.255438804626465,
        3.3859338760375977,
        3.5481371879577637,
        3.6881251335144043,
        3.931969404220581,
        3.7120590209960938,
        4.253988265991211,
        4.40582799911499,
        4.3987345695495605,
        5.124852657318115,
        5.208556175231934,
        5.528006553649902,
        5.438188076019287,
        5.1184587478637695,
        5.861950397491455,
        5.925510883331299,
        6.721064567565918,
        7.168274402618408,
        7.494100093841553,
        7.802031517028809,
        8.131532669067383,
        8.831541061401367,
        8.948741912841797,
        9.252861022949219,
        10.001102447509766,
        10.513477325439453,
        11.22576904296875,
        11.651196479797363,
        12.1062650680542,
        12.825406074523926,
        13.624258041381836,
        14.095122337341309,
        15.16834831237793,
        16.11112403869629,
        16.79478645324707,
        17.716222763061523,
        19.008102416992188,
        20.508451461791992,
        20.903255462646484,
        22.013059616088867,
        23.206283569335938,
        23.48196792602539,
        24.219533920288086,
        24.22395133972168,
        24.543760299682617,
        24.464540481567383,
        24.17816734313965,
        24.204059600830078,
        24.31369400024414,
        24.490829467773438,
        24.613317489624023,
        24.571718215942383,
        24.2219181060791,
        24.08186149597168,
        23.6059513092041,
        23.35520362854004,
        22.888134002685547,
        24.8461856842041,
        27.19505500793457,
        27.442758560180664,
        27.24441909790039,
        27.065317153930664,
        26.8559627532959,
        26.68889045715332,
        26.47962188720703,
        26.001651763916016,
        25.615921020507812,
        25.115522384643555,
        24.22187042236328,
        23.820682525634766,
        23.527528762817383,
        23.532957077026367
    ],
    "scatter_angle_deg": [
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0,
        5.0
    ],
    "cherenkov_core_spread_xy": [
        {
            "x_mean": 4.877368927001953,
            "y_mean": 28.41268539428711,
            "major_axis_x": 0.09341379171960595,
            "major_axis_y": -0.9956273718196813,
            "minor_axis_x": -0.9956273718196813,
            "minor_axis_y": -0.09341379171960595,
            "major_std": 95.3379416360142,
            "minor_std": 62.51791440842489
        },
        {
            "x_mean": -9.086030006408691,
            "y_mean": -36.113914489746094,
            "major_axis_x": -0.3296061488149716,
            "major_axis_y": -0.9441185236310974,
            "minor_axis_x": -0.9441185236310974,
            "minor_axis_y": 0.3296061488149716,
            "major_std": 94.18104306526179,
            "minor_std": 43.24120323296071
        },
        {
            "x_mean": 3.5798842906951904,
            "y_mean": -1.3963239192962646,
            "major_axis_x": -0.16661010075949903,
            "major_axis_y": -0.9860228568978051,
            "minor_axis_x": -0.9860228568978051,
            "minor_axis_y": 0.16661010075949903,
            "major_std": 93.31788117654267,
            "minor_std": 62.80273781723293
        },
        {
            "x_mean": -13.335831642150879,
            "y_mean": -28.604778289794922,
            "major_axis_x": -0.10979689767970058,
            "major_axis_y": -0.9939540438369941,
            "minor_axis_x": -0.9939540438369941,
            "minor_axis_y": 0.10979689767970058,
            "major_std": 173.15220896304822,
            "minor_std": 52.92558860767708
        },
        {
            "x_mean": -12.645206451416016,
            "y_mean": -48.201622009277344,
            "major_axis_x": 0.15427466159825604,
            "major_axis_y": -0.9880280000024005,
            "minor_axis_x": -0.9880280000024005,
            "minor_axis_y": -0.15427466159825604,
            "major_std": 116.5889966779227,
            "minor_std": 59.48580119343002
        },
        {
            "x_mean": 10.278511047363281,
            "y_mean": 32.62458419799805,
            "major_axis_x": 0.16175774307923085,
            "major_axis_y": -0.9868304983906372,
            "minor_axis_x": -0.9868304983906372,
            "minor_axis_y": -0.16175774307923085,
            "major_std": 120.37547414144596,
            "minor_std": 60.98247926361448
        },
        {
            "x_mean": -46.47304916381836,
            "y_mean": 1.797048568725586,
            "major_axis_x": 0.03619645932630555,
            "major_axis_y": -0.9993446934527841,
            "minor_axis_x": -0.9993446934527841,
            "minor_axis_y": -0.03619645932630555,
            "major_std": 133.17974409997814,
            "minor_std": 64.2399832217015
        },
        {
            "x_mean": -18.447280883789062,
            "y_mean": -17.52264976501465,
            "major_axis_x": -0.18623050782487774,
            "major_axis_y": -0.9825060803655558,
            "minor_axis_x": -0.9825060803655558,
            "minor_axis_y": 0.18623050782487774,
            "major_std": 153.56400269373623,
            "minor_std": 62.32113945892214
        },
        {
            "x_mean": 4.401113986968994,
            "y_mean": -78.30939483642578,
            "major_axis_x": 0.009022815373176408,
            "major_axis_y": -0.9999592935728643,
            "minor_axis_x": -0.9999592935728643,
            "minor_axis_y": -0.009022815373176408,
            "major_std": 169.2778587887268,
            "minor_std": 57.206339538357845
        },
        {
            "x_mean": -6.300957202911377,
            "y_mean": -39.47954177856445,
            "major_axis_x": 0.019235617038295922,
            "major_axis_y": -0.9998149784020822,
            "minor_axis_x": -0.9998149784020822,
            "minor_axis_y": -0.019235617038295922,
            "major_std": 193.5952283534064,
            "minor_std": 67.95026539372508
        },
        {
            "x_mean": -7.379662036895752,
            "y_mean": 11.51677417755127,
            "major_axis_x": 0.08769718963137511,
            "major_axis_y": -0.9961471793519062,
            "minor_axis_x": -0.9961471793519062,
            "minor_axis_y": -0.08769718963137511,
            "major_std": 157.70104351259968,
            "minor_std": 70.05014169059027
        },
        {
            "x_mean": -13.27949047088623,
            "y_mean": -21.55782127380371,
            "major_axis_x": 0.07493292817592728,
            "major_axis_y": -0.9971885760852766,
            "minor_axis_x": -0.9971885760852766,
            "minor_axis_y": -0.07493292817592728,
            "major_std": 177.09520068606338,
            "minor_std": 49.7925417142675
        },
        {
            "x_mean": -34.94961166381836,
            "y_mean": -0.31201687455177307,
            "major_axis_x": 0.1472608471228366,
            "major_axis_y": -0.9890976912846702,
            "minor_axis_x": -0.9890976912846702,
            "minor_axis_y": -0.1472608471228366,
            "major_std": 148.48123252093623,
            "minor_std": 61.8178206994541
        },
        {
            "x_mean": 4.674803733825684,
            "y_mean": -4.201416492462158,
            "major_axis_x": -0.051039905043004895,
            "major_axis_y": -0.9986966146399021,
            "minor_axis_x": -0.9986966146399021,
            "minor_axis_y": 0.051039905043004895,
            "major_std": 135.21224604818897,
            "minor_std": 71.52064000446276
        },
        {
            "x_mean": 23.414932250976562,
            "y_mean": -58.028324127197266,
            "major_axis_x": 0.04960753008468528,
            "major_axis_y": -0.9987687885386173,
            "minor_axis_x": -0.9987687885386173,
            "minor_axis_y": -0.04960753008468528,
            "major_std": 235.8630674386785,
            "minor_std": 70.6097591429933
        },
        {
            "x_mean": -2.2404730319976807,
            "y_mean": -59.815025329589844,
            "major_axis_x": 0.00537679023989759,
            "major_axis_y": -0.9999855449588838,
            "minor_axis_x": -0.9999855449588838,
            "minor_axis_y": -0.00537679023989759,
            "major_std": 212.323849580004,
            "minor_std": 84.36415411335776
        },
        {
            "x_mean": -14.363957405090332,
            "y_mean": -52.28575897216797,
            "major_axis_x": -0.10584737649075136,
            "major_axis_y": -0.9943823876608159,
            "minor_axis_x": -0.9943823876608159,
            "minor_axis_y": 0.10584737649075136,
            "major_std": 211.55616161147756,
            "minor_std": 88.18963488786294
        },
        {
            "x_mean": -6.182802677154541,
            "y_mean": 2.1806631088256836,
            "major_axis_x": 0.022681720172917388,
            "major_axis_y": -0.9997427366927941,
            "minor_axis_x": -0.9997427366927941,
            "minor_axis_y": -0.022681720172917388,
            "major_std": 262.03499223726317,
            "minor_std": 98.12985285650875
        },
        {
            "x_mean": 6.039264678955078,
            "y_mean": -6.00606632232666,
            "major_axis_x": 0.07865143488991358,
            "major_axis_y": -0.9969021776432017,
            "minor_axis_x": -0.9969021776432017,
            "minor_axis_y": -0.07865143488991358,
            "major_std": 185.60296398860703,
            "minor_std": 83.18068565808667
        },
        {
            "x_mean": -1.0441182851791382,
            "y_mean": 4.127781867980957,
            "major_axis_x": -0.022934268765473848,
            "major_axis_y": -0.9997369750670388,
            "minor_axis_x": -0.9997369750670388,
            "minor_axis_y": 0.022934268765473848,
            "major_std": 209.16002331856487,
            "minor_std": 106.20847559746068
        },
        {
            "x_mean": -29.739185333251953,
            "y_mean": -58.384437561035156,
            "major_axis_x": 0.09187039833006838,
            "major_axis_y": -0.9957709726190428,
            "minor_axis_x": -0.9957709726190428,
            "minor_axis_y": -0.09187039833006838,
            "major_std": 250.16762033104177,
            "minor_std": 112.80231562610801
        },
        {
            "x_mean": -14.761399269104004,
            "y_mean": -73.89630126953125,
            "major_axis_x": 0.036642181502610685,
            "major_axis_y": -0.9993284497775142,
            "minor_axis_x": -0.9993284497775142,
            "minor_axis_y": -0.036642181502610685,
            "major_std": 229.4744483257459,
            "minor_std": 95.36468912325941
        },
        {
            "x_mean": -38.17118835449219,
            "y_mean": -18.57733726501465,
            "major_axis_x": 0.016963837643445383,
            "major_axis_y": -0.9998561037531385,
            "minor_axis_x": -0.9998561037531385,
            "minor_axis_y": -0.016963837643445383,
            "major_std": 274.3221844278428,
            "minor_std": 110.65546404359696
        },
        {
            "x_mean": -36.45991516113281,
            "y_mean": -28.736083984375,
            "major_axis_x": -0.021073283667004464,
            "major_axis_y": -0.9997779337010245,
            "minor_axis_x": -0.9997779337010245,
            "minor_axis_y": 0.021073283667004464,
            "major_std": 261.7260853844503,
            "minor_std": 135.6475350264744
        },
        {
            "x_mean": -21.74488639831543,
            "y_mean": -12.320792198181152,
            "major_axis_x": 0.0009469823909633903,
            "major_axis_y": -0.9999995516120751,
            "minor_axis_x": -0.9999995516120751,
            "minor_axis_y": -0.0009469823909633903,
            "major_std": 226.99130649511852,
            "minor_std": 109.43456555711695
        },
        {
            "x_mean": 8.71650218963623,
            "y_mean": -43.06867599487305,
            "major_axis_x": -0.027245094376098133,
            "major_axis_y": -0.9996287835153795,
            "minor_axis_x": -0.9996287835153795,
            "minor_axis_y": 0.027245094376098133,
            "major_std": 257.96178646262007,
            "minor_std": 111.2647258866717
        },
        {
            "x_mean": -31.497318267822266,
            "y_mean": -49.26482009887695,
            "major_axis_x": 0.14951484219919206,
            "major_axis_y": -0.9887594813513297,
            "minor_axis_x": -0.9887594813513297,
            "minor_axis_y": -0.14951484219919206,
            "major_std": 240.92036023576426,
            "minor_std": 123.90922400977232
        },
        {
            "x_mean": 1.3535264730453491,
            "y_mean": -16.168804168701172,
            "major_axis_x": -0.06326921878578944,
            "major_axis_y": -0.9979964959629046,
            "minor_axis_x": -0.9979964959629046,
            "minor_axis_y": 0.06326921878578944,
            "major_std": 303.47376616793105,
            "minor_std": 127.83268364277143
        },
        {
            "x_mean": -43.302242279052734,
            "y_mean": -60.13451385498047,
            "major_axis_x": 0.03477943888267286,
            "major_axis_y": -0.999395012310451,
            "minor_axis_x": -0.999395012310451,
            "minor_axis_y": -0.03477943888267286,
            "major_std": 291.11832219048176,
            "minor_std": 130.42994899724374
        },
        {
            "x_mean": -42.862579345703125,
            "y_mean": -68.38358306884766,
            "major_axis_x": -0.054103290480416684,
            "major_axis_y": -0.9985353443715408,
            "minor_axis_x": -0.9985353443715408,
            "minor_axis_y": 0.054103290480416684,
            "major_std": 284.88954138664985,
            "minor_std": 135.81422926890764
        },
        {
            "x_mean": -72.87916564941406,
            "y_mean": -90.00184631347656,
            "major_axis_x": 0.09568065608598343,
            "major_axis_y": -0.9954120815275229,
            "minor_axis_x": -0.9954120815275229,
            "minor_axis_y": -0.09568065608598343,
            "major_std": 299.26379214204144,
            "minor_std": 162.7379828320425
        },
        {
            "x_mean": -13.987114906311035,
            "y_mean": -45.629878997802734,
            "major_axis_x": 0.013836133669595126,
            "major_axis_y": -0.9999042761210081,
            "minor_axis_x": -0.9999042761210081,
            "minor_axis_y": -0.013836133669595126,
            "major_std": 295.55690295327906,
            "minor_std": 159.93960444228378
        },
        {
            "x_mean": -47.576751708984375,
            "y_mean": -53.18877029418945,
            "major_axis_x": -0.03287775411398618,
            "major_axis_y": -0.9994593805074923,
            "minor_axis_x": -0.9994593805074923,
            "minor_axis_y": 0.03287775411398618,
            "major_std": 281.373316031114,
            "minor_std": 163.5359159599479
        },
        {
            "x_mean": -44.97462844848633,
            "y_mean": -69.67920684814453,
            "major_axis_x": 0.14261371194176667,
            "major_axis_y": -0.9897784242779748,
            "minor_axis_x": -0.9897784242779748,
            "minor_axis_y": -0.14261371194176667,
            "major_std": 319.8774512617191,
            "minor_std": 179.12295492294024
        },
        {
            "x_mean": -25.354848861694336,
            "y_mean": -69.7385025024414,
            "major_axis_x": -0.008749277441004502,
            "major_axis_y": -0.999961724339617,
            "minor_axis_x": -0.999961724339617,
            "minor_axis_y": 0.008749277441004502,
            "major_std": 274.4838248272782,
            "minor_std": 173.43296917855614
        },
        {
            "x_mean": -31.75177764892578,
            "y_mean": -69.66962432861328,
            "major_axis_x": 0.04051451046440531,
            "major_axis_y": -0.9991789501594944,
            "minor_axis_x": -0.9991789501594944,
            "minor_axis_y": -0.04051451046440531,
            "major_std": 310.6896809891371,
            "minor_std": 180.5280753382682
        },
        {
            "x_mean": -79.54703521728516,
            "y_mean": -117.80660247802734,
            "major_axis_x": -0.00048544122955300185,
            "major_axis_y": -0.9999998821733994,
            "minor_axis_x": -0.9999998821733994,
            "minor_axis_y": 0.00048544122955300185,
            "major_std": 288.9010032939374,
            "minor_std": 181.22452948038477
        },
        {
            "x_mean": -78.95043182373047,
            "y_mean": -76.32955932617188,
            "major_axis_x": -0.11968994765611964,
            "major_axis_y": -0.992811319652468,
            "minor_axis_x": -0.992811319652468,
            "minor_axis_y": 0.11968994765611964,
            "major_std": 280.28326586776706,
            "minor_std": 224.82357969250776
        },
        {
            "x_mean": -55.7789192199707,
            "y_mean": -102.70733642578125,
            "major_axis_x": -0.00878433588045231,
            "major_axis_y": -0.9999614169772449,
            "minor_axis_x": -0.9999614169772449,
            "minor_axis_y": 0.00878433588045231,
            "major_std": 316.8532158475555,
            "minor_std": 238.2275303809615
        },
        {
            "x_mean": -94.18048858642578,
            "y_mean": -89.00513458251953,
            "major_axis_x": -0.14816919071230217,
            "major_axis_y": -0.988962027038279,
            "minor_axis_x": -0.988962027038279,
            "minor_axis_y": 0.14816919071230217,
            "major_std": 310.2221240634128,
            "minor_std": 227.54295845962108
        },
        {
            "x_mean": -107.26814270019531,
            "y_mean": -166.72689819335938,
            "major_axis_x": -0.44267901122052394,
            "major_axis_y": -0.8966801509037763,
            "minor_axis_x": -0.8966801509037763,
            "minor_axis_y": 0.44267901122052394,
            "major_std": 322.7526474505808,
            "minor_std": 242.96903579738955
        },
        {
            "x_mean": -57.41716384887695,
            "y_mean": -131.61122131347656,
            "major_axis_x": -0.41315898238108345,
            "major_axis_y": -0.9106589126988367,
            "minor_axis_x": -0.9106589126988367,
            "minor_axis_y": 0.41315898238108345,
            "major_std": 337.85199070090283,
            "minor_std": 269.19855985477864
        },
        {
            "x_mean": -58.10515594482422,
            "y_mean": -134.9040985107422,
            "major_axis_x": -0.5543687878614373,
            "major_axis_y": -0.8322711379382567,
            "minor_axis_x": -0.8322711379382567,
            "minor_axis_y": 0.5543687878614373,
            "major_std": 360.9639605343387,
            "minor_std": 296.03339010218986
        },
        {
            "x_mean": -94.18643951416016,
            "y_mean": -167.04869079589844,
            "major_axis_x": 0.8144580082910089,
            "major_axis_y": 0.580222502778583,
            "minor_axis_x": -0.580222502778583,
            "minor_axis_y": 0.8144580082910089,
            "major_std": 385.6897493513738,
            "minor_std": 318.90801960964546
        },
        {
            "x_mean": -38.56057357788086,
            "y_mean": -171.72605895996094,
            "major_axis_x": 0.8096224993203092,
            "major_axis_y": 0.5869509422382213,
            "minor_axis_x": -0.5869509422382213,
            "minor_axis_y": 0.8096224993203092,
            "major_std": 406.9538177424131,
            "minor_std": 309.92397369424066
        },
        {
            "x_mean": -24.938243865966797,
            "y_mean": -119.82239532470703,
            "major_axis_x": 0.7908897284527215,
            "major_axis_y": 0.6119586893148755,
            "minor_axis_x": -0.6119586893148755,
            "minor_axis_y": 0.7908897284527215,
            "major_std": 417.3308918942047,
            "minor_std": 293.4508282331304
        },
        {
            "x_mean": -112.07048034667969,
            "y_mean": -163.59686279296875,
            "major_axis_x": 0.8307655450068168,
            "major_axis_y": 0.5566225015479761,
            "minor_axis_x": -0.5566225015479761,
            "minor_axis_y": 0.8307655450068168,
            "major_std": 390.5047660284449,
            "minor_std": 313.60882870723873
        },
        {
            "x_mean": -127.1743392944336,
            "y_mean": -200.59027099609375,
            "major_axis_x": 0.9656949347829523,
            "major_axis_y": 0.2596792115949011,
            "minor_axis_x": -0.2596792115949011,
            "minor_axis_y": 0.9656949347829523,
            "major_std": 389.9885844618631,
            "minor_std": 326.7937400946677
        },
        {
            "x_mean": -93.58741760253906,
            "y_mean": -197.02818298339844,
            "major_axis_x": 0.8541670465968582,
            "major_axis_y": 0.5199987081791656,
            "minor_axis_x": -0.5199987081791656,
            "minor_axis_y": 0.8541670465968582,
            "major_std": 442.0047657615192,
            "minor_std": 323.03583560077334
        },
        {
            "x_mean": -56.60499572753906,
            "y_mean": -131.27330017089844,
            "major_axis_x": 0.8335340705496642,
            "major_axis_y": 0.5524680563009117,
            "minor_axis_x": -0.5524680563009117,
            "minor_axis_y": 0.8335340705496642,
            "major_std": 451.9242380738613,
            "minor_std": 359.76790206868526
        },
        {
            "x_mean": -57.680870056152344,
            "y_mean": -211.09237670898438,
            "major_axis_x": 0.7391712396772075,
            "major_axis_y": 0.6735175412964833,
            "minor_axis_x": -0.6735175412964833,
            "minor_axis_y": 0.7391712396772075,
            "major_std": 508.1086285800959,
            "minor_std": 330.36136227564623
        },
        {
            "x_mean": -11.002885818481445,
            "y_mean": -224.91220092773438,
            "major_axis_x": -0.6564282263993825,
            "major_axis_y": -0.7543884832009045,
            "minor_axis_x": -0.7543884832009045,
            "minor_axis_y": 0.6564282263993825,
            "major_std": 666.9370280976735,
            "minor_std": 402.7596069204075
        },
        {
            "x_mean": -96.30531311035156,
            "y_mean": -233.70225524902344,
            "major_axis_x": 0.7146952052877398,
            "major_axis_y": 0.6994360324852555,
            "minor_axis_x": -0.6994360324852555,
            "minor_axis_y": 0.7146952052877398,
            "major_std": 664.7416526604708,
            "minor_std": 464.09042125381217
        },
        {
            "x_mean": -81.95835876464844,
            "y_mean": -144.8272705078125,
            "major_axis_x": -0.647233381258007,
            "major_axis_y": -0.7622919061523135,
            "minor_axis_x": -0.7622919061523135,
            "minor_axis_y": 0.647233381258007,
            "major_std": 686.6058006685727,
            "minor_std": 422.85346708811477
        },
        {
            "x_mean": -146.57566833496094,
            "y_mean": -106.11731719970703,
            "major_axis_x": -0.67505178058295,
            "major_axis_y": -0.737770352841444,
            "minor_axis_x": -0.737770352841444,
            "minor_axis_y": 0.67505178058295,
            "major_std": 715.3388204012485,
            "minor_std": 481.78000166293
        },
        {
            "x_mean": -54.08855438232422,
            "y_mean": -283.26617431640625,
            "major_axis_x": -0.5729412985712502,
            "major_axis_y": -0.8195964057946384,
            "minor_axis_x": -0.8195964057946384,
            "minor_axis_y": 0.5729412985712502,
            "major_std": 701.0355505837932,
            "minor_std": 495.95128021511243
        },
        {
            "x_mean": -86.4460678100586,
            "y_mean": -234.00413513183594,
            "major_axis_x": -0.5891125804629745,
            "major_axis_y": -0.8080509684049982,
            "minor_axis_x": -0.8080509684049982,
            "minor_axis_y": 0.5891125804629745,
            "major_std": 924.3670137893432,
            "minor_std": 496.4930803119023
        },
        {
            "x_mean": -96.98236846923828,
            "y_mean": 3.5469424724578857,
            "major_axis_x": -0.5718621903809403,
            "major_axis_y": -0.8203497030003201,
            "minor_axis_x": -0.8203497030003201,
            "minor_axis_y": 0.5718621903809403,
            "major_std": 879.3911260979012,
            "minor_std": 474.9386564444568
        },
        {
            "x_mean": 39.73841857910156,
            "y_mean": -70.4476089477539,
            "major_axis_x": -0.5330234291224735,
            "major_axis_y": -0.846100481034327,
            "minor_axis_x": -0.846100481034327,
            "minor_axis_y": 0.5330234291224735,
            "major_std": 914.0687621731594,
            "minor_std": 492.295045094182
        },
        {
            "x_mean": -119.92554473876953,
            "y_mean": -154.9098663330078,
            "major_axis_x": -0.45011768370951033,
            "major_axis_y": -0.8929692440459442,
            "minor_axis_x": -0.8929692440459442,
            "minor_axis_y": 0.45011768370951033,
            "major_std": 1010.9190732910902,
            "minor_std": 536.1500312881597
        },
        {
            "x_mean": -246.67727661132812,
            "y_mean": -7.604035377502441,
            "major_axis_x": -0.43453960557669696,
            "major_axis_y": -0.900652725075125,
            "minor_axis_x": -0.900652725075125,
            "minor_axis_y": 0.43453960557669696,
            "major_std": 1229.116513007066,
            "minor_std": 537.1533245928409
        },
        {
            "x_mean": -173.65435791015625,
            "y_mean": -104.04597473144531,
            "major_axis_x": -0.5742801554819517,
            "major_axis_y": -0.8186588440978484,
            "minor_axis_x": -0.8186588440978484,
            "minor_axis_y": 0.5742801554819517,
            "major_std": 1301.7959291742568,
            "minor_std": 515.8309434143905
        },
        {
            "x_mean": -123.44876861572266,
            "y_mean": -144.49681091308594,
            "major_axis_x": -0.5596413436741666,
            "major_axis_y": -0.8287349192899821,
            "minor_axis_x": -0.8287349192899821,
            "minor_axis_y": 0.5596413436741666,
            "major_std": 1278.4028334443954,
            "minor_std": 550.8226983690605
        },
        {
            "x_mean": -71.50566101074219,
            "y_mean": -164.08990478515625,
            "major_axis_x": -0.5423198161353865,
            "major_axis_y": -0.8401721353549406,
            "minor_axis_x": -0.8401721353549406,
            "minor_axis_y": 0.5423198161353865,
            "major_std": 1264.7677128693274,
            "minor_std": 552.7974103945614
        },
        {
            "x_mean": -90.92987823486328,
            "y_mean": 78.68331146240234,
            "major_axis_x": -0.5914468059855255,
            "major_axis_y": -0.8063440182016112,
            "minor_axis_x": -0.8063440182016112,
            "minor_axis_y": 0.5914468059855255,
            "major_std": 1314.5588369239301,
            "minor_std": 545.3271399198636
        },
        {
            "x_mean": -213.9393768310547,
            "y_mean": -91.8975830078125,
            "major_axis_x": -0.5366833527951653,
            "major_axis_y": -0.8437837275229597,
            "minor_axis_x": -0.8437837275229597,
            "minor_axis_y": 0.5366833527951653,
            "major_std": 1278.143639864894,
            "minor_std": 572.2099173550661
        },
        {
            "x_mean": -0.33843928575515747,
            "y_mean": -125.33503723144531,
            "major_axis_x": -0.5115995281288597,
            "major_axis_y": -0.8592240236506008,
            "minor_axis_x": -0.8592240236506008,
            "minor_axis_y": 0.5115995281288597,
            "major_std": 1248.5293147184616,
            "minor_std": 589.4236292876166
        },
        {
            "x_mean": -103.20791625976562,
            "y_mean": 115.22234344482422,
            "major_axis_x": -0.6117090822936785,
            "major_axis_y": -0.7910828013801245,
            "minor_axis_x": -0.7910828013801245,
            "minor_axis_y": 0.6117090822936785,
            "major_std": 1315.7044563427687,
            "minor_std": 523.6415198915527
        },
        {
            "x_mean": -93.98468017578125,
            "y_mean": -75.30227661132812,
            "major_axis_x": -0.49225259526834175,
            "major_axis_y": -0.870452401025801,
            "minor_axis_x": -0.870452401025801,
            "minor_axis_y": 0.49225259526834175,
            "major_std": 1254.4247047289227,
            "minor_std": 650.6234218019297
        },
        {
            "x_mean": -111.2365951538086,
            "y_mean": -63.74583053588867,
            "major_axis_x": -0.5050654275737289,
            "major_axis_y": -0.8630810586901825,
            "minor_axis_x": -0.8630810586901825,
            "minor_axis_y": 0.5050654275737289,
            "major_std": 1280.9459901413434,
            "minor_std": 601.9683738380303
        },
        {
            "x_mean": -87.56392669677734,
            "y_mean": 181.00637817382812,
            "major_axis_x": -0.4389596719220124,
            "major_axis_y": -0.8985067648193413,
            "minor_axis_x": -0.8985067648193413,
            "minor_axis_y": 0.4389596719220124,
            "major_std": 1283.2960250909703,
            "minor_std": 618.5569570130481
        },
        {
            "x_mean": -16.190357208251953,
            "y_mean": -6.04542350769043,
            "major_axis_x": -0.36933005403417735,
            "major_axis_y": -0.9292982896718962,
            "minor_axis_x": -0.9292982896718962,
            "minor_axis_y": 0.36933005403417735,
            "major_std": 1375.5676383200152,
            "minor_std": 654.5210625907197
        },
        {
            "x_mean": -31.05984878540039,
            "y_mean": -42.487545013427734,
            "major_axis_x": -0.38410034678205396,
            "major_axis_y": -0.9232913535834211,
            "minor_axis_x": -0.9232913535834211,
            "minor_axis_y": 0.38410034678205396,
            "major_std": 1412.0599686579044,
            "minor_std": 606.7486853568397
        },
        {
            "x_mean": -51.984500885009766,
            "y_mean": 239.40126037597656,
            "major_axis_x": -0.3832687657221176,
            "major_axis_y": -0.9236368622038883,
            "minor_axis_x": -0.9236368622038883,
            "minor_axis_y": 0.3832687657221176,
            "major_std": 1274.3497437317303,
            "minor_std": 733.8640239668115
        },
        {
            "x_mean": 54.9135856628418,
            "y_mean": -180.17205810546875,
            "major_axis_x": -0.2858773878683264,
            "major_axis_y": -0.9582662047184919,
            "minor_axis_x": -0.9582662047184919,
            "minor_axis_y": 0.2858773878683264,
            "major_std": 1302.1977695159708,
            "minor_std": 568.8015716853944
        }
    ]
}

work_dir = os.path.join(".", "examples", "analysis_magnetic_deflection")
os.makedirs(work_dir, exist_ok=True)

keys = {
    'azimuth_phi_deg': {"unit": "deg", "name": "azimuth-phi"},
    'zenith_theta_deg': {"unit": "deg", "name": "zenith-distance-theta"},
    'instrument_x': {"unit": "m", "name": "telescope-x"},
    'instrument_y': {"unit": "m", "name": "telescope-y"}
}

info_str = "{:.1f}km a.s.l., Atm.-Mod. {:d}, Bx {:.1f}uT, Bz {:.1f}uT".format(
    t['input']['site']['observation_level_altitude_asl']*1e-3,
    t['input']['site']["corsika_atmosphere_model"],
    t['input']['site']["earth_magnetic_field_x_muT"],
    t['input']['site']["earth_magnetic_field_z_muT"])

for key in keys:
    figsize = (6, 4)
    dpi = 320
    ax_size = (0.15, 0.15, 0.80, 0.75)
    fig = plt.figure(figsize=figsize, dpi=dpi)
    ax = fig.add_axes(ax_size)
    ax.plot(
        t["energy"],
        t[key],
        'ko')
    ax.set_title(info_str)
    ax.semilogx()
    ax.spines['right'].set_visible(False)
    ax.spines['top'].set_visible(False)
    ax.set_xlabel('energy / GeV')
    ax.set_ylabel(
        '{key:s} / {unit:s}'.format(
            key=keys[key]["name"],
            unit=keys[key]["unit"]))
    ax.grid(color='k', linestyle='-', linewidth=0.66, alpha=0.1)
    fig.savefig(
        os.path.join(
            work_dir,
            '{:s}.png'.format(keys[key]["name"])))


energies = t["energy"]
xs = t["instrument_x"]
ys = t["instrument_y"]

ellipses = t["cherenkov_core_spread_xy"]

major_axis_x = [e["major_axis_x"] for e in ellipses]
major_axis_y = [e["major_axis_y"] for e in ellipses]
minor_axis_x = [e["minor_axis_x"] for e in ellipses]
minor_axis_y = [e["minor_axis_y"] for e in ellipses]
major_std = [e["major_std"] for e in ellipses]
minor_std = [e["minor_std"] for e in ellipses]


figsize = (6, 10)
dpi = 360
fig = plt.figure(figsize=figsize, dpi=dpi)
ax = fig.add_axes(ax_size)
for i in range(len(xs)):
    ax.plot(xs[i], ys[i], 'ko')
    start_x = xs[i]
    start_y = ys[i]
    major_end_x = start_x + major_axis_x[i]*major_std[i]
    major_end_y = start_y + major_axis_y[i]*major_std[i]
    ax.plot([start_x, major_end_x], [start_y, major_end_y], 'k-')
    major_end_x = start_x - major_axis_x[i]*major_std[i]
    major_end_y = start_y - major_axis_y[i]*major_std[i]
    ax.plot([start_x, major_end_x], [start_y, major_end_y], 'k-')

    minor_end_x = start_x + minor_axis_x[i]*minor_std[i]
    minor_end_y = start_y + minor_axis_y[i]*minor_std[i]
    ax.plot([start_x, minor_end_x], [start_y, minor_end_y], 'k:')
    minor_end_x = start_x - minor_axis_x[i]*minor_std[i]
    minor_end_y = start_y - minor_axis_y[i]*minor_std[i]
    ax.plot([start_x, minor_end_x], [start_y, minor_end_y], 'k:')

    if np.mod(i, 10) == 0 and energies[i] < 6:
        ax.text(start_x+500, start_y-500, "{:.1f}GeV".format(energies[i]))
ax.text(-5.9e3, -2e3, "major axis")
ax.plot([-7e3, -6e3], [-2e3, -2e3], "k-")
ax.text(-5.9e3, -2.4e3, "minor axis")
ax.plot([-7e3, -6e3], [-2.4e3, -2.4e3], "k:")
ax.set_title(info_str)
ax.spines['right'].set_visible(False)
ax.spines['top'].set_visible(False)
ax.set_xlabel('x / m')
ax.set_ylabel('y / m')
ax.grid(color='k', linestyle='-', linewidth=0.66, alpha=0.1)
ax.set_aspect("equal")
fig.savefig(
    os.path.join(
        work_dir,
        'cherenkov-light-pool-spread.png'))
